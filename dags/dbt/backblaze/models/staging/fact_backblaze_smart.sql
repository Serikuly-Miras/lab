{{ config(
    materialized = 'table',
    post_hook = [ "CREATE INDEX IF NOT EXISTS idx_fact_backblaze_smart_date_serial_number_btree ON {{ this }} USING btree (date, serial_number);" ]
) }}

SELECT
    b.date,
    b.serial_number,
    -- SMART Attributes
    b.smart_1_raw,
    b.smart_2_normalized,
    b.smart_2_raw,
    b.smart_3_normalized,
    b.smart_3_raw,
    b.smart_4_normalized,
    b.smart_4_raw,
    b.smart_5_normalized,
    b.smart_5_raw,
    b.smart_7_normalized,
    b.smart_7_raw,
    b.smart_8_normalized,
    b.smart_8_raw,
    b.smart_9_normalized,
    b.smart_9_raw,
    b.smart_10_normalized,
    b.smart_10_raw,
    b.smart_11_normalized,
    b.smart_11_raw,
    b.smart_12_normalized,
    b.smart_12_raw,
    b.smart_13_normalized,
    b.smart_13_raw,
    b.smart_15_normalized,
    b.smart_15_raw,
    b.smart_16_normalized,
    b.smart_16_raw,
    b.smart_17_normalized,
    b.smart_17_raw,
    b.smart_18_normalized,
    b.smart_18_raw,
    b.smart_22_normalized,
    b.smart_22_raw,
    b.smart_23_normalized,
    b.smart_23_raw,
    b.smart_24_normalized,
    b.smart_24_raw,
    b.smart_27_normalized,
    b.smart_27_raw,
    b.smart_71_normalized,
    b.smart_71_raw,
    b.smart_82_normalized,
    b.smart_82_raw,
    b.smart_90_normalized,
    b.smart_90_raw,
    b.smart_160_normalized,
    b.smart_160_raw,
    b.smart_161_normalized,
    b.smart_161_raw,
    b.smart_163_normalized,
    b.smart_163_raw,
    b.smart_164_normalized,
    b.smart_164_raw,
    b.smart_165_normalized,
    b.smart_165_raw,
    b.smart_166_normalized,
    b.smart_166_raw,
    b.smart_167_normalized,
    b.smart_167_raw,
    b.smart_168_normalized,
    b.smart_168_raw,
    b.smart_169_normalized,
    b.smart_169_raw,
    b.smart_170_normalized,
    b.smart_170_raw,
    b.smart_171_normalized,
    b.smart_171_raw,
    b.smart_172_normalized,
    b.smart_172_raw,
    b.smart_173_normalized,
    b.smart_173_raw,
    b.smart_174_normalized,
    b.smart_174_raw,
    b.smart_175_normalized,
    b.smart_175_raw,
    b.smart_176_normalized,
    b.smart_176_raw,
    b.smart_177_normalized,
    b.smart_177_raw,
    b.smart_178_normalized,
    b.smart_178_raw,
    b.smart_179_normalized,
    b.smart_179_raw,
    b.smart_180_normalized,
    b.smart_180_raw,
    b.smart_181_normalized,
    b.smart_181_raw,
    b.smart_182_normalized,
    b.smart_182_raw,
    b.smart_183_normalized,
    b.smart_183_raw,
    b.smart_184_normalized,
    b.smart_184_raw,
    b.smart_187_normalized,
    b.smart_187_raw,
    b.smart_188_normalized,
    b.smart_188_raw,
    b.smart_189_normalized,
    b.smart_189_raw,
    b.smart_190_normalized,
    b.smart_190_raw,
    b.smart_191_normalized,
    b.smart_191_raw,
    b.smart_192_normalized,
    b.smart_192_raw,
    b.smart_193_normalized,
    b.smart_193_raw,
    b.smart_194_normalized,
    b.smart_194_raw,
    b.smart_195_normalized,
    b.smart_195_raw,
    b.smart_196_normalized,
    b.smart_196_raw,
    b.smart_197_normalized,
    b.smart_197_raw,
    b.smart_198_normalized,
    b.smart_198_raw,
    b.smart_199_normalized,
    b.smart_199_raw,
    b.smart_200_normalized,
    b.smart_200_raw,
    b.smart_201_normalized,
    b.smart_201_raw,
    b.smart_202_normalized,
    b.smart_202_raw,
    b.smart_206_normalized,
    b.smart_206_raw,
    b.smart_210_normalized,
    b.smart_210_raw,
    b.smart_211_normalized,
    b.smart_211_raw,
    b.smart_212_normalized,
    b.smart_212_raw,
    b.smart_218_normalized,
    b.smart_218_raw,
    b.smart_220_normalized,
    b.smart_220_raw,
    b.smart_222_normalized,
    b.smart_222_raw,
    b.smart_223_normalized,
    b.smart_223_raw,
    b.smart_224_normalized,
    b.smart_224_raw,
    b.smart_225_normalized,
    b.smart_225_raw,
    b.smart_226_normalized,
    b.smart_226_raw,
    b.smart_230_normalized,
    b.smart_230_raw,
    b.smart_231_normalized,
    b.smart_231_raw,
    b.smart_232_normalized,
    b.smart_232_raw,
    b.smart_233_normalized,
    b.smart_233_raw,
    b.smart_234_normalized,
    b.smart_234_raw,
    b.smart_235_normalized,
    b.smart_235_raw,
    b.smart_240_normalized,
    b.smart_240_raw,
    b.smart_241_normalized,
    b.smart_241_raw,
    b.smart_242_normalized,
    b.smart_242_raw,
    b.smart_244_normalized,
    b.smart_244_raw,
    b.smart_245_normalized,
    b.smart_245_raw,
    b.smart_246_normalized,
    b.smart_246_raw,
    b.smart_247_normalized,
    b.smart_247_raw,
    b.smart_248_normalized,
    b.smart_248_raw,
    b.smart_250_normalized,
    b.smart_250_raw,
    b.smart_251_normalized,
    b.smart_251_raw,
    b.smart_252_normalized,
    b.smart_252_raw,
    b.smart_254_normalized,
    b.smart_254_raw,
    b.smart_255_normalized,
    b.smart_255_raw
FROM
    bronze.backblaze b
